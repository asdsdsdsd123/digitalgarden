---
{"dg-publish":true,"dg-home":null,"permalink":"/02 SAS/01 SAS基础知识点/关于-RTF文件格式相关知识点/","dgPassFrontmatter":true}
---

          

# 关于|RTF文件格式相关知识点

网络 [[javascript:void(0\|法迈医讯]];)

**法迈医讯** ![](https://mp.weixin.qq.com/s/0LdqbWPN4JJw0bWKQ4mbFg)

微信号 cdiscgroup

功能介绍 法迈新媒体---本着“资源整合，知识共享”的初心，致力服务于（新药研发，临床试验，医药外包服务，新药注册与上市等等）医药行业从业人员。汇集：新闻热点，市场动态，干货知识，政策法规，产业链分析等等资讯。

_2021-07-28 07:52_ _发表于_

收录于合集

[[http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533135&idx=1&sn=98db9f0b1d2a433986284a56cc687f43&chksm=fe605dc8c917d4de6d9641e715f7c46036b2c0ae3ffe2a073fb9027a2d285755c4eeb6061712&scene=21#wechat_redirect\|http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533135&idx=1&sn=98db9f0b1d2a433986284a56cc687f43&chksm=fe605dc8c917d4de6d9641e715f7c46036b2c0ae3ffe2a073fb9027a2d285755c4eeb6061712&scene=21#wechat_redirect]][[http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533135&idx=1&sn=98db9f0b1d2a433986284a56cc687f43&chksm=fe605dc8c917d4de6d9641e715f7c46036b2c0ae3ffe2a073fb9027a2d285755c4eeb6061712&scene=21#wechat_redirect\|http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533135&idx=1&sn=98db9f0b1d2a433986284a56cc687f43&chksm=fe605dc8c917d4de6d9641e715f7c46036b2c0ae3ffe2a073fb9027a2d285755c4eeb6061712&scene=21#wechat_redirect]]**[[http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533135&idx=1&sn=98db9f0b1d2a433986284a56cc687f43&chksm=fe605dc8c917d4de6d9641e715f7c46036b2c0ae3ffe2a073fb9027a2d285755c4eeb6061712&scene=21#wechat_redirect\|http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533135&idx=1&sn=98db9f0b1d2a433986284a56cc687f43&chksm=fe605dc8c917d4de6d9641e715f7c46036b2c0ae3ffe2a073fb9027a2d285755c4eeb6061712&scene=21#wechat_redirect]]**

[[http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533546&idx=1&sn=7bafc9ff47872c9f1c21b959267a5087&chksm=fe605c6dc917d57b03f96321f2fbbf20167939046d9fb4324ad98295fc90c0047627b44ac3de&scene=21#wechat_redirect\|http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533546&idx=1&sn=7bafc9ff47872c9f1c21b959267a5087&chksm=fe605c6dc917d57b03f96321f2fbbf20167939046d9fb4324ad98295fc90c0047627b44ac3de&scene=21#wechat_redirect]]

[[http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533546&idx=1&sn=7bafc9ff47872c9f1c21b959267a5087&chksm=fe605c6dc917d57b03f96321f2fbbf20167939046d9fb4324ad98295fc90c0047627b44ac3de&scene=21#wechat_redirect\|http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533546&idx=1&sn=7bafc9ff47872c9f1c21b959267a5087&chksm=fe605c6dc917d57b03f96321f2fbbf20167939046d9fb4324ad98295fc90c0047627b44ac3de&scene=21#wechat_redirect]]  

[[http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533135&idx=1&sn=98db9f0b1d2a433986284a56cc687f43&chksm=fe605dc8c917d4de6d9641e715f7c46036b2c0ae3ffe2a073fb9027a2d285755c4eeb6061712&scene=21#wechat_redirect\|http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533135&idx=1&sn=98db9f0b1d2a433986284a56cc687f43&chksm=fe605dc8c917d4de6d9641e715f7c46036b2c0ae3ffe2a073fb9027a2d285755c4eeb6061712&scene=21#wechat_redirect]]  

[[http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533377&idx=2&sn=18f8cb18c1eb1d89bb93c873472f1e93&chksm=fe605cc6c917d5d076fb6fac232db516b1964b0c579f076586bb4b7f7712c8e98df7cca0e394&scene=21#wechat_redirect\|http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533377&idx=2&sn=18f8cb18c1eb1d89bb93c873472f1e93&chksm=fe605cc6c917d5d076fb6fac232db516b1964b0c579f076586bb4b7f7712c8e98df7cca0e394&scene=21#wechat_redirect]]  

**[[http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533348&idx=2&sn=1c5321a2b8ee44b99b5e91e236cb8e82&chksm=fe605ca3c917d5b579c2e7aaae004e539b46615004d3419cb0c6051389038563682ab603cbe9&scene=21#wechat_redirect\|http://mp.weixin.qq.com/s?__biz=MzU5NjQ2MjMxMg==&mid=2247533348&idx=2&sn=1c5321a2b8ee44b99b5e91e236cb8e82&chksm=fe605ca3c917d5b579c2e7aaae004e539b46615004d3419cb0c6051389038563682ab603cbe9&scene=21#wechat_redirect]]**

  

  

**RTF****文件格式研究报告(代开版辞)**  

**摘要：**本文对RTF文件格式进行分析研究，对RTF文件结构及特性进行了阐述，并分别列举了几个实用性的例子进行详细分析，最终通过VB程序代码实现了一个RTF书写器(不具有所见即所得特性)。本文对软件开发人员及RTF文件格式感兴趣的人员具有参考价值。

**关键字：**RTF、Rich Text Format、Office、文件格式。

**一、引言**

富文本格式(RTF)规范是为了便于在应用程序之间轻松转储格式化文本和图形的一种编码方法。现在，用户可以利用特定转换软件，在不同系统如MS-DOS、Windows、OS/2、Macintosh和Power Macintosh的应用程序之间转移字处理文档。RTF规范提供一种在不同的输出设备、操作环境和操作系统之间交换文本和图形的一种格式。RTF使用ANSI, PC-8, Macintosh, 或IBM PC字符集控制文档的表示法和格式化，包括屏幕显示和打印。凭借RTF规范，不同的操作系统和不同的软件程序创建的文档能够在这些操作系统和应用程序之间传递。

将一个格式化的文件转换为RTF文件的软件称为RTF书写器。RTF书写器用于分离现有文本中的程序控制信息，并且生成一个包含文本和与之相关的RTF组的新文件。将RTF文件转换成格式化文件的软件则称为RTF阅读器。

----

**二、RTF基本语法**

RTF文件由未格式化本文、控制字、控制符和组组成。RTF文件没有限制文件的行的最大长度。

**控制字**是RTF用来标记打印控制符和管理文档信息的一种特殊格式的命令。一个控制字最长32个字符。控制字的使用格式如下:

\字母序列<分隔符>

注意：每个控制字均以一个反斜杠\开头。字母序列由a～z 的小写字母组成。控制字(或者称为关键字)通常应该不包含任何大写字母。

**分隔符**标记RTF控制字的结束, 可以是下列各项之一:

一个空格，这时空格是控制字的一部份。

一个数字或连字符(-), 表示跟随的一个数值参数。该数字序列的长度由其后的一个空格或除了字母和数字的其他字符划定。这个参数可以是正数或者负数，它的取值范围通常是从-32767到32767。

任何非字母和数字的其他字符。这种情况下，此分隔字符结束控制字，而它并不属于控制字的一部分。

**控制符**由一个反斜线\跟随单个非字母字符组成。例如，**\~**代表一个不换行空格。控制符不需要分隔符。

**组**由包括在({})中的文本、控制字或控制符组成。左扩符({)表示组的开始，右扩符(})表示组的结束。每个组包括文本和文本的不同属性。RTF文件也能同时包括字体、格式、屏幕颜色、图形、脚注、注释(注解)、文件头和文件尾、摘要信息、域和书签的组合，以及文档、区段、段落和字符的格式属性。如果包括字体、文件、格式、屏幕颜色、校订标记，以及摘要信息组、文档格式属性，则他们一定要在文件的第一纯文本字符之前，这些组形成RTF的文件头。如果包括字体组,则它应该在格式组之前。如果组未使用,可以省略。

对于RTF文件的详细语法及关键字说明请参阅《Rich Text Format (RTF) Specification v1.7》，这里不作更详细的说明。

**三、****Hello Word**

国际惯例，一个Hello Word!演示例子，内容如下：

该文件分析如下(红色)：

1、文件基本属性：

{\rtf1 RTF版本\ansi字符集\ansicpg936简体中文\deff0默认字体0\deflang1033美国英语\deflangfe2052中国汉语

2、字体表：

{\fonttbl{\f0字体0\fmodern\fprq6字体间距为6\fcharset134GB2312国标码\'cb\'ce\'cc\'e5宋体;}}

3、生成器信息：

{\*\generatorMsftedit 5.41.21.2500;}

4、文档属性：

\viewkind4正常视图\uc1单字节\pard默认段落属性\lang2052中国汉语\f0字体0\fs20字体大小20磅

5、正文文本：

Hello World!\par段落标记

}文件结束

注意：在RTF文件中，中文等双字节字符采用其单字节ASCII码序列表示，例如文本“宋体ABC”应该表示为：\'cb\'ce\'cc\'e5ABC，这就是为什么RTF可读性差的原因。如果需要通过程序获取某个字符串的合法ASCII序列，可以采用如下的VB函数：

![图片](https://mmbiz.qpic.cn/mmbiz_png/jVAic1rIjicErNB4PfVqo02ThzqdZ1M8odS2A9ET8xD9171gsT3FLLliau7ibDVGIicvsgYM4S0eUicQKl5AtY4qdY6w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

**四、文字的更高级表示**

掌握了基本文字表述方法后，你一定会试着进一步探索文本更高级的表示方法，如下划线、颜色、粗体、斜体等等，而这些在V1.7规范中都作了详细描述，本文只列出部分常用关键字，以供参考。

1 对于字体表和颜色表的说明：

对于我们在文档中使用的每一个字体和颜色，我们都必须在文档头的字体表和颜色表中预先定义。

字体表定义的例子如下：

![图片](https://mmbiz.qpic.cn/mmbiz_png/jVAic1rIjicErNB4PfVqo02ThzqdZ1M8odH5wUekxhuQqLCP8Khnk6DSeiblBiboUDudT7ica0ib49cK0skJkrprib5xw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

我们在使用字体时就可以直接指定字体表的一个索引，如：“\f1Happy”表示字体为Arial 的文本Happy。如果我们想加入其他字体，如“华文中宋”那么只需要在字体表中加入该字体说明，并在需要时引用该字体索引值即可。方法为(华文中宋的ASCII串为“\'bb\'aa\'ce\'c4\'d6\'d0\'cb\'ce”)：{f222\fnil\fcharset134\fprq2\'bb\'aa\'ce\'c4\'d6\'d0\'cb\'ce;}，然后通过\f222来引用该字体即可。

颜色表定义的例子如下：

![图片](https://mmbiz.qpic.cn/mmbiz_png/jVAic1rIjicErNB4PfVqo02ThzqdZ1M8odDicCav04zgelANBmOQdoNJtx5mjn3y1DPmR3fnPY46dWn81c1icdhqRg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

颜色表中每个颜色值采用RGB格式书写，每个颜色用分号格开，注意第一个颜色值\c0为空，表示系统默认颜色(一般为黑色)。依次为：\0、\1、\2、… …。我们在使用颜色时(如字体颜色)就可以指定某一个颜色索引值，如“\cf2Sunday”表示字体颜色为RGB(0,0,255)蓝色的文字Sundy。“\cb6ABC”表示字体背景色为RGB(255,0,0)的文字“ABC”。如果我们需要加入其他颜色值，只需要在颜色表中加入颜色定义，并通过相应的索引值来引用它即可。

## 1. 2 字符底纹语法如下：

![图片](https://mmbiz.qpic.cn/mmbiz_png/jVAic1rIjicEpO1kz3ricbjpB2c04ibSVy4kUUJtt2quK0hyIcbuiajDOZtiaFj2z1N3Hz1PJPt1gxiazTic2kmh36cjPw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

## 2. 3 字符下划线语法如下：
假设我们`希望得到背景为水平线、字体为华文中宋(字体索引为222)、颜色为红色(颜色索引为6)的文本“星期天”，则只需输入：\f222\cf6\'bb\'aa\'ce\'c4\'d6\'d0\'cb\'ce即可。`

![图片](https://mmbiz.qpic.cn/mmbiz_png/jVAic1rIjicEpO1kz3ricbjpB2c04ibSVy4k5gKibPZnL9nqt6VVq9BczovfqticH5iablxicdtdurAtJAXO8V8Bu8GTrQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

## 3. 4 其他文本显示高级属性-下划线语法。
下划线语法与前面底纹的使用相同。  

![图片](https://mmbiz.qpic.cn/mmbiz_png/jVAic1rIjicEpO1kz3ricbjpB2c04ibSVy4kia8roLd0VBKztYAsxLibCev9DGMkCm7TJB7QdWNicUxhiayZQQW4exNpsw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

## 4. 5 对齐方式语法

![图片](https://mmbiz.qpic.cn/mmbiz_png/jVAic1rIjicEpO1kz3ricbjpB2c04ibSVy4kz3lgUMepQxz8OTR9IjkaOvHpDrYsr2rib0IfaJDWj8WoGnibIibicm0CwQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

## 5. 文本缩进语法

![图片](https://mmbiz.qpic.cn/mmbiz_png/jVAic1rIjicEpO1kz3ricbjpB2c04ibSVy4kN4deOhDHNoIcMBbSaC6NRJice0e9OcsY3oib32MIBPwicia7THrxC7yyjA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

## 6. 文本间距语法

![图片](https://mmbiz.qpic.cn/mmbiz_png/jVAic1rIjicErNB4PfVqo02ThzqdZ1M8odSic4l4bL1B9B2w9s7xIfBiaaib4JCmV1ic9II3CBVKYHrCMVH7Rwa6TsBw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

因为篇幅限制，更详细的文本格式分析请参阅附件里的文本示例分析原文。

**五、图片的表示方式**

摸清RTF中图片的表示颇费了一番周折，下面的分析希望能够加速你的学习进程。一个RTF图片数据通常直接嵌入文件中，这些图象可以是16进制(默认的)或2进制格式。图象属于目标引用，由\pict 控制字开始。如后面的例子中将描述的，\pict关键字应在\*\shppict引用控制关键字之后。

一个图象的例子如下：

![图片](https://mp.weixin.qq.com/s/0LdqbWPN4JJw0bWKQ4mbFgdata:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

其分析如下(红色)：

{\*\shppict图片(引用)

{\pict图片开始

绘图对象属性(这个组可以省略)：

{\*\picprop表示这里是应用于一个内嵌图象的形状属性\shplid1025标识每个图形的唯一数值

{\sp绘图对象属性定义

{\sn shapeType}{\sv75}} 图片类型为相框

{\sp{\sn fFlipH}{\sv0}} 水平翻转:False

{\sp{\sn fFlipV}{\sv0}} 垂直翻转:False

{\sp{\snpibFlags}{\sv 2}} 链接图片标志

{\sp{\sn fLine}{\sv0}}具有线条:False

{\sp{\sn fLayoutInCell}{\sv1}}允许图形锚点定位在单元格内部:True

}绘图对象属性定义结束

图片属性：

\picscalex100水平缩放比例\picscaley100垂直缩放比例

\piccropl0左端剪切值=0\piccropr0右端剪切值=0\piccropt0上端剪切值=0\piccropb0下端剪切值=0

\picw4516图片的像素宽度\pich4516图片的像素高度\picwgoal2560图象期望宽度\pichgoal2560图象期望高度\jpegblip图片源为一个JPEG文件\bliptag图象ID标识-728883813

{\*\blipuidd48e1d9b2268ef9f2741709749fb439c}

图片16进制数据：

ffd8ffe000104a46494600010101004800480000ffdb0043000604040405040605050609060506090b080606080b0c0a0a0b0a0a0c100c0c0c0c0c0c100c0e0f}16进制图片数据结束

}

兼容性wMetaFile文件内容(可用省略)：

{\nonshppict只用于兼容，不读取

{\pict图片开始

\picscalex100\picscaley100\piccropl0\piccropr0\piccropt0\piccropb0\picw4516\pich4516\picwgoal2560\pichgoal2560\wmetafile8\bliptag-728883813\blipupi72

{\*\blipuidd48e1d9b2268ef9f2741709749fb439c}

下面是MetaFile类型的16进制数据：

0100090000034660000000002160000000000400000003010800050000000b0200000000050000000c02ac00ac00030000001e00040000000701040021600000

}MetaFile类型16进制图片数据结束

}

为了简化分析，我们除去所以可以省略的内容，则一副图片可以这样表示：

{\*\shppict{\pictpiccropl0\piccropr0\piccropt0\piccropb0\picw宽度\pich高度\picwgoal显示宽度\pichgoal显示高度\jpegblipJPEG类型\bliptag-728883813ＩＤ值(为一个负的长整形值)

下面是该图片的实际16进制数据：

ffd8ffe0001… …}}

如果需要通过程序获取指定图片合法的16进制字符串，可以采用如下的VB函数：

![图片](https://mp.weixin.qq.com/s/0LdqbWPN4JJw0bWKQ4mbFgdata:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

**六、表格基本表示方法**

上面对文本和图片都进行了分析，相信你已经对RTF文件格式有了一定体会，接下来说明RTF文件中表的表示方法。表的定义稍显复杂，不过还是有规律可循的。不存在RTF表组，实际上表由段落属性来描述。一个表表现为多个表行的顺序排列。一个表行是一个由不同单元格组成的段落序列。简言之，表格由行组成，行由单元格组成。不管有多复杂的表格，它都是通过一行接一行的描述来实现的，包括表格的嵌套。表行从控制字\trowd开始，\row结束。包含在一个表行中的每个段落必须指定\intbl控制字或者从前一段落继承。一个单元内可能有多个段落；单元由单元格标志(\cell控制字)结束，行由行标志(\row控制字)结束。表行也可以被绝对定位。此时，表行的每个段落必须具有相同的定位控制字。表的属性可以从前一行继承；因此，连续的表行可以通过单一的<tbldef>来定义。

一个简单表格例子如下：

1,1

1,2

1,3

2,1

2,2

2,3

RTF内容如下：

![图片](https://mp.weixin.qq.com/s/0LdqbWPN4JJw0bWKQ4mbFgdata:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

是不是很复杂？不过没关系，我们通过对其进行分段，并加入适当注释，你就会对RTF文件中的表结构一目了然。首先需要声明的是，RTF1.7规范中规定，表行的格式如下：(<tbldef> <cell>+<tbldef> \row) | (<tbldef> <cell>+ \row) | (<cell>+<tbldef> \row)，目前Word2003采用的方式就是第一种，即“定义＋内容＋重复定义”，如此一来就会有很大的数据冗余，这就是为什么Word2003的一个简单文档都会很大的原因，不过为了兼容性考虑，这样处理也是必要的。其定义也由“行定义＋单元格定义”组成，其中单元格定义可用重复。

分析代码如下(红色)：

表格行1

\trowd表行1开始

表格属性

\trgaph108表中单元格半间距\trleft-108表的最左边位置

行边框设置

\trbrdrt行的上边框\brdrs单倍厚度\brdrw10线宽

\trbrdrl行的左边框\brdrs单倍厚度\brdrw10线宽

\trbrdrb行的下边框\brdrs单倍厚度\brdrw10线宽

\trbrdrr行的右边框\brdrs单倍厚度\brdrw10线宽

单元格1边框设置

\clbrdrt单元格上边框\brdrw15线宽\brdrs单倍厚度

\clbrdrl单元格左边框\brdrw15线宽\brdrs单倍厚度

\clbrdrb单元格下边框\brdrw15线宽\brdrs单倍厚度

\clbrdrr单元格右边框\brdrw15线宽\brdrs单倍厚度

\cellx2732单元格右边界

单元格2边框设置

\clbrdrt单元格上边框\brdrw15线宽\brdrs单倍厚度

\clbrdrl单元格左边框\brdrw15线宽\brdrs单倍厚度

\clbrdrb单元格下边框\brdrw15线宽\brdrs单倍厚度

\clbrdrr单元格右边框\brdrw15线宽\brdrs单倍厚度

\cellx5573单元格右边界

单元格3边框设置

\clbrdrt单元格上边框\brdrw15线宽\brdrs单倍厚度

\clbrdrl单元格左边框\brdrw15线宽\brdrs单倍厚度

\clbrdrb单元格下边框\brdrw15线宽\brdrs单倍厚度

\clbrdrr单元格右边框\brdrw15线宽\brdrs单倍厚度

\cellx8414单元格右边界

行1数据

\pard重置段落属性\intbl段落是表的一部分\kerning2紧缩字符尺寸\f0字体0\fs21尺寸21

1,1 1,1 \cell表单元格1结束

1,2 1,2 \cell表单元格2结束

1,3 1,3 \cell表单元格3结束

\f1字体1

\row表行1结束

\f0字体0

表格行2

\trowd表行2开始

\trgaph108表中单元格半间距\trleft-108表的最左边位置

行边框设置

\trbrdrt\brdrs\brdrw10

\trbrdrl\brdrs\brdrw10

\trbrdrb\brdrs\brdrw10

\trbrdrr\brdrs\brdrw10

单元格1边框设置

\clbrdrt\brdrw15\brdrs

\clbrdrl\brdrw15\brdrs

\clbrdrb\brdrw15\brdrs

\clbrdrr\brdrw15\brdrs

\cellx2732

单元格2边框设置

\clbrdrt\brdrw15\brdrs

\clbrdrl\brdrw15\brdrs

\clbrdrb\brdrw15\brdrs

\clbrdrr\brdrw15\brdrs

\cellx5573

单元格3边框设置

\clbrdrt\brdrw15\brdrs

\clbrdrl\brdrw15\brdrs

\clbrdrb\brdrw15\brdrs

\clbrdrr\brdrw15\brdrs

\cellx8414

行2数据

\intbl 段落是表的一部分

2,1 2,1\cell表单元格1结束

2,2 2,2\cell表单元格2结束

2,3 2,3\cell表单元格3结束

\f1字体1

\row表行2结束

至此，你应该对RTF表格输出有一定认识了吧。当然在表格中插入图片、嵌入表格等的实现方法同理，嵌入的图片可以等同于一段文本来处理，但是嵌套表格的实现可能比较复杂，因为它涉及段落文本嵌套层次等高级问题，这里不再详述，有兴趣的读者可以参考《Rich Text Format (RTF)Specification v1.7》。

  

**七、小结：****RTF****文档基本结构**

通过对RTF文件的分析，我们得出一个RTF文件基本结构如下：

    RTF文件<File>

文件头<header>

    RTF版本\rtf

    字符集<charset>

    默认字体区域设置<deffont>

    默认字体号\deff?

    字体表<fonttbl>

    文件表<filetbl>?

    颜色表<colortbl>?

    样式表<stylesheet>?

    编目表<listtables>?

        编目表{ \*\listtable }

        编目替换表{ \*\listoverridetable }

    段落组属性{ \*\pgptbl }

    跟踪修订<revtbl>?

    RSID表<rsidtable>?

    生成器信息<generator>?

文档区<document>

    文档信息区<info>?

        标题<title>?

        主题<subject>?

        作者<author>?

        经理<manager>?

        公司<company>?

        最后修改者<operator>?

        文档类别<category>?

        关键字<keywords>?

        注释<comment>?

        文档的版本号\version?

        Word摘要信息中的注释<doccomm>?

        内部版本号\vern?

        创建时间<creatim>?

        修订时间<revtim>?

        最后打印时间<printim>?

         备份时间<buptim>?

         总编辑时间(单位：分钟)\edmins?

        页数\nofpages?

        字数\nofwords?

        包含空格的总字符数\nofchars?

        内部ID号\id?

    文档格式属性<docfmt>*

        节文本<section>+

             节格式属性<secfmt>*

             页眉页脚设置<hdrftr>?

        段落文本<para>+

             文本<textpar>|

                  项目符号与编号<pn>?

                  段落边框<brdrdef>?

                  段落格式属性<parfmt>*

                  定位对象与边框<apoctl>*

                  制表位设置<tabdef>?

                  段落底纹<shading>?

                  隐藏与否(/v /spv)?

             表格<row>

                  行开始\trowd

                  行定义<tbldef>

                  单元格<cell>+

                      单元格定义+

                      单元格内容+

                  重复行定义<tbldef>

                  行结束\row

        字符文本<char>+

        图片<pict>

             图片开始{\*\shppict {\pict }

             图片属性

             图片数据

        对象<obj>

        绘图对象\shp

        脚注\footnote

        注释<annot>

        域<field>
